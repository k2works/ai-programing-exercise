# 非機能要件定義書

## 1. 概要

### 1.1 目的
会議室予約システムの非機能要件を定義し、システムの品質特性と制約条件を明確化する。

### 1.2 対象範囲
本システムの非機能要件は以下の観点から定義する：
- パフォーマンス
- セキュリティ
- 可用性・信頼性
- ユーザビリティ・アクセシビリティ
- 拡張性・保守性
- 運用性

### 1.3 参照ドキュメント
- [要件定義書](../requirements/requirements_definition.md)
- [バックエンドアーキテクチャ](architecture_backend.md)
- [フロントエンドアーキテクチャ](architecture_frontend.md)
- [技術スタック](tech_stack.md)
- [テスト戦略](test_strategy.md)

## 2. パフォーマンス要件

### 2.1 応答性能要件

| 項目 | 要件 | 測定条件 | 目標値 |
|------|------|----------|--------|
| **画面遷移時間** | ページロード時間 | 通常の業務時間帯 | 2秒以内 |
| **検索応答時間** | 会議室検索レスポンス | 100件以下の結果 | 1秒以内 |
| **予約処理時間** | 予約登録・更新処理 | 単一予約操作 | 3秒以内 |
| **API応答時間** | RESTful API レスポンス | P95 パーセンタイル | 500ms以内 |

### 2.2 スループット要件

| 項目 | 要件 | 測定条件 | 目標値 |
|------|------|----------|--------|
| **同時ユーザー数** | 最大同時接続ユーザー | ピーク時間帯 | 200ユーザー |
| **API処理能力** | 秒間リクエスト処理数 | 通常負荷時 | 100 RPS |
| **データベース処理** | 秒間クエリ実行数 | ピーク負荷時 | 500 QPS |

### 2.3 拡張性要件

| 項目 | 要件 | 実装方針 |
|------|------|----------|
| **水平スケーリング** | アプリケーション層の負荷分散対応 | Docker コンテナ + ロードバランサー |
| **データベース拡張** | リードレプリカ対応 | PostgreSQL マスタースレーブ構成 |
| **キャッシュ戦略** | 頻繁アクセスデータのキャッシュ | Redis 導入検討 |

## 3. セキュリティ要件

### 3.1 認証・認可要件

| 項目 | 要件 | 実装方針 |
|------|------|----------|
| **認証方式** | 社内 Active Directory 連携 | LDAP 認証 + JWT Bearer トークン |
| **セッション管理** | トークンベース認証 | JWT（有効期限：8時間） |
| **権限管理** | ロールベースアクセス制御 | 一般ユーザー・管理者の2段階 |
| **パスワードポリシー** | AD 準拠 | 複雑性要件、定期変更 |

### 3.2 データ保護要件

| 項目 | 要件 | 実装方針 |
|------|------|----------|
| **通信暗号化** | HTTPS 通信の強制 | TLS 1.3、HSTS ヘッダー |
| **データベース暗号化** | 機密データの暗号化 | PostgreSQL Transparent Data Encryption |
| **ログ保護** | 個人情報のマスキング | 構造化ログでの PII マスキング |
| **入力値検証** | SQLインジェクション対策 | JPA Criteria API、入力値サニタイズ |

### 3.3 セキュリティ監査要件

| 項目 | 要件 | 実装方針 |
|------|------|----------|
| **アクセスログ** | 全API アクセスの記録 | Spring Boot Actuator + 構造化ログ |
| **認証ログ** | 認証成功・失敗の記録 | セキュリティイベントログ |
| **データ変更ログ** | 予約データ変更の監査証跡 | JPA Auditing |

## 4. 可用性・信頼性要件

### 4.1 可用性要件

| 項目 | 要件 | 目標値 | 実装方針 |
|------|------|--------|----------|
| **稼働率** | システム稼働率 | 99.5% | 冗長化構成、定期メンテナンス |
| **サービス時間** | 24時間365日稼働 | - | セルフサービス運用 |
| **計画停止時間** | 月次メンテナンス | 4時間以内 | 深夜時間帯での実施 |

### 4.2 信頼性要件

| 項目 | 要件 | 目標値 | 実装方針 |
|------|------|--------|----------|
| **MTBF** | 平均故障間隔 | 720時間以上 | 品質保証プロセス |
| **MTTR** | 平均復旧時間 | 2時間以内 | 監視・アラート、自動復旧 |
| **データ整合性** | データ損失防止 | 100% | ACID 準拠、バックアップ |

### 4.3 障害対応要件

| 項目 | 要件 | 実装方針 |
|------|------|----------|
| **障害検知** | 自動障害検知・通知 | Prometheus + Alertmanager |
| **フェイルオーバー** | 障害時の自動切り替え | ヘルスチェック + ロードバランサー |
| **データバックアップ** | 日次自動バックアップ | PostgreSQL WAL-E、7日間保持 |

## 5. ユーザビリティ・アクセシビリティ要件

### 5.1 ユーザビリティ要件

| 項目 | 要件 | 目標値 | 実装方針 |
|------|------|--------|----------|
| **学習容易性** | 初回利用でも直感的操作 | 3クリック以内で予約完了 | Material-UI、一貫した UI 設計 |
| **操作効率性** | 業務時間短縮 | 従来比90%短縮 | ワンクリック予約、予約テンプレート |
| **エラー回避** | 操作ミスの防止 | - | バリデーション、確認ダイアログ |
| **満足度** | ユーザー満足度 | 80%以上 | UI/UX 改善の継続的実施 |

### 5.2 アクセシビリティ要件

| 項目 | 要件 | 準拠基準 | 実装方針 |
|------|------|----------|----------|
| **WCAG準拠** | ウェブアクセシビリティ | WCAG 2.1 AA | セマンティック HTML、ARIA 属性 |
| **キーボード操作** | マウスレス操作対応 | 全機能 | Tab キー順序、ショートカット |
| **視覚的配慮** | 色覚異常者への対応 | - | カラーユニバーサルデザイン |
| **画面読み上げ** | スクリーンリーダー対応 | - | 適切な見出し構造、代替テキスト |

### 5.3 多言語・多デバイス要件

| 項目 | 要件 | 対応範囲 | 実装方針 |
|------|------|----------|----------|
| **多言語対応** | 日英2言語サポート | UI全体 | React i18next |
| **レスポンシブデザイン** | マルチデバイス対応 | デスクトップ・タブレット・スマートフォン | CSS Flexbox、Material-UI Grid |
| **ブラウザ対応** | 主要ブラウザサポート | Chrome、Firefox、Safari、Edge | 最新2バージョン |

## 6. 拡張性・保守性要件

### 6.1 拡張性要件

| 項目 | 要件 | 実装方針 |
|------|------|----------|
| **機能拡張性** | 新機能追加の容易性 | ヘキサゴナルアーキテクチャ、DDD |
| **データ拡張性** | データ量増加への対応 | パーティション、インデックス最適化 |
| **統合拡張性** | 外部システム連携 | RESTful API、非同期メッセージング |

### 6.2 保守性要件

| 項目 | 要件 | 実装方針 |
|------|------|----------|
| **コード品質** | 保守しやすいコード | SOLID 原則、Clean Code |
| **テスト可能性** | 自動テスト実行 | テストピラミッド（単体80%、結合15%、E2E5%） |
| **文書化** | 技術文書の保守 | ADR、API ドキュメント、運用手順書 |
| **コード解析** | 静的解析・品質測定 | SonarQube、コードカバレッジ 80% 以上 |

### 6.3 技術的負債管理

| 項目 | 要件 | 実装方針 |
|------|------|----------|
| **依存関係管理** | ライブラリの脆弱性対応 | Dependabot、定期更新 |
| **リファクタリング** | 継続的改善 | 定期的コードレビュー、技術的負債の可視化 |
| **バージョン管理** | 後方互換性の確保 | セマンティックバージョニング |

## 7. 運用性要件

### 7.1 監視・ログ要件

| 項目 | 要件 | 実装方針 |
|------|------|----------|
| **アプリケーション監視** | リアルタイム監視 | Micrometer + Prometheus + Grafana |
| **ログ管理** | 集約・検索・分析 | ELK Stack（Elasticsearch、Logstash、Kibana） |
| **メトリクス収集** | パフォーマンス指標 | CPU、メモリ、DB 接続、API レスポンス時間 |
| **アラート通知** | 異常時の自動通知 | Slack 連携、メール通知 |

### 7.2 デプロイ・運用要件

| 項目 | 要件 | 実装方針 |
|------|------|----------|
| **自動デプロイ** | CI/CD パイプライン | GitHub Actions、Docker コンテナ |
| **環境管理** | 開発・ステージング・本番環境 | Docker Compose、環境変数管理 |
| **ロールバック** | 障害時の迅速復旧 | Blue-Green デプロイメント |
| **構成管理** | インフラコード化 | Terraform、設定ファイルのバージョン管理 |

### 7.3 バックアップ・災害復旧要件

| 項目 | 要件 | 実装方針 |
|------|------|----------|
| **データバックアップ** | 自動バックアップ | 日次フルバックアップ、増分バックアップ |
| **バックアップ保存** | 長期保存 | 90日間保存、オフサイトバックアップ |
| **復旧手順** | 災害復旧計画 | RTO: 4時間、RPO: 24時間 |
| **復旧テスト** | 定期的復旧訓練 | 四半期ごとの復旧テスト実施 |

## 8. コンプライアンス・規制要件

### 8.1 データ保護規制

| 項目 | 要件 | 対応方針 |
|------|------|----------|
| **個人情報保護** | 個人情報保護法準拠 | プライバシーポリシー、同意管理 |
| **データ削除権** | 利用者のデータ削除要求 | 論理削除、物理削除機能 |
| **データポータビリティ** | データエクスポート機能 | CSV、JSON 形式でのデータ出力 |

### 8.2 内部統制要件

| 項目 | 要件 | 対応方針 |
|------|------|----------|
| **変更管理** | システム変更の統制 | 承認プロセス、変更履歴管理 |
| **アクセス制御** | 職務分離の原則 | 開発・運用環境の分離、権限管理 |
| **監査証跡** | 操作ログの保存 | 改ざん防止、7年間保存 |

## 9. 制約条件

### 9.1 技術的制約

| 項目 | 制約内容 | 影響 |
|------|----------|------|
| **既存システム連携** | Active Directory との連携必須 | 認証方式の制約 |
| **ネットワーク** | 社内ネットワーク環境での運用 | セキュリティ要件、パフォーマンス |
| **ブラウザサポート** | IE サポート不要 | モダンブラウザのみ対応 |

### 9.2 運用制約

| 項目 | 制約内容 | 影響 |
|------|----------|------|
| **保守体制** | 平日日中のみサポート | 障害対応時間の制限 |
| **予算制約** | クラウド費用の上限設定 | インフラスケーリングの制限 |
| **リソース制約** | 開発チーム2名体制 | 開発スケジュール、機能優先度 |

## 10. 品質目標と測定方法

### 10.1 品質目標

| 品質特性 | 目標値 | 測定方法 | 責任者 |
|----------|--------|----------|--------|
| **パフォーマンス** | API レスポンス時間 < 500ms | APM ツール | 開発チーム |
| **可用性** | 稼働率 99.5% | 監視ツール | 運用チーム |
| **セキュリティ** | 脆弱性ゼロ | 脆弱性スキャン | セキュリティ担当 |
| **ユーザビリティ** | ユーザー満足度 80% | アンケート調査 | プロダクトオーナー |

### 10.2 継続的改善

| 活動 | 頻度 | 実施内容 |
|------|------|----------|
| **パフォーマンス測定** | 週次 | レスポンス時間、スループット測定 |
| **セキュリティ監査** | 月次 | 脆弱性スキャン、アクセスログ監査 |
| **ユーザーフィードバック** | 四半期 | ユーザー満足度調査、改善要望収集 |
| **技術負債評価** | 月次 | コード品質メトリクス、リファクタリング計画 |

---

## 11. 改訂履歴

| バージョン | 日付 | 改訂内容 | 作成者 |
|------------|------|----------|--------|
| 1.0 | 2024-XX-XX | 初版作成 | 開発チーム |

---

本文書は、会議室予約システムの非機能要件を包括的に定義し、システムの品質特性を明確化するものである。各要件は、システムの運用開始から継続的な改善活動まで、全ライフサイクルを通じて参照・更新される。