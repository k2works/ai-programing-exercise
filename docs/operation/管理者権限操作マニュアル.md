# 管理者権限操作マニュアル

## 概要

会議室予約システム（MRS）の管理者専用機能の操作ガイドです。管理者は全ユーザーの予約を管理し、キャンセル操作の履歴を確認できます。

## 管理者権限の確認

管理者としてログインすると、ユーザー情報に「Admin」ロールが表示されます。

```
ようこそ、管理者さん (Admin)
```

## 管理者専用機能

### 1. 管理機能ボタン

画面右上のヘッダー部分に以下のボタンが表示されます：

- **管理機能**：全予約の管理パネルを開く
- **履歴表示**：キャンセル操作履歴を表示
- **ログアウト**：システムからログアウト

### 2. 管理者キャンセル機能

#### 2.1 管理パネルの開き方

1. 画面右上の「管理機能」ボタンをクリック
2. 管理者キャンセル機能パネルが開く

#### 2.2 予約検索とフィルタリング

**検索機能**
- 検索ボックスに以下の条件で検索可能：
  - 予約タイトル
  - ユーザーID
  - 会議室ID

**ステータスフィルター**
- 全て
- 確定
- キャンセル済み

#### 2.3 予約一覧の表示項目

各予約カードには以下の情報が表示されます：

- 予約タイトル
- 予約者（ユーザーID）
- 会議室ID
- 開始・終了時刻
- 参加者一覧
- 予約ステータス
- 作成・更新日時

#### 2.4 管理者によるキャンセル操作

**キャンセル可能な予約**
- ステータスが「確定」の予約のみ
- 過去の予約はキャンセル不可

**キャンセル手順**
1. 対象予約の「キャンセル」ボタンをクリック
2. キャンセル理由ダイアログが表示される
3. キャンセル理由を入力（必須、500文字以内）
4. 「予約をキャンセル」ボタンをクリック
5. 確認メッセージが表示されたらキャンセル完了

**管理者コメント機能**
- 管理者による詳細なコメントを記録
- 監査ログに管理者専用情報が保存される

### 3. キャンセル履歴表示

#### 3.1 履歴表示の開き方

1. 画面右上の「履歴表示」ボタンをクリック
2. キャンセル履歴ダイアログが開く

#### 3.2 履歴表示機能

**表示項目**
- 監査ID
- 対象予約ID
- 実行者
- 実行日時
- キャンセル理由
- 管理者コメント（管理者操作の場合）
- ユーザーロール
- IPアドレス（セキュリティ情報）

**ソート機能**
- 実行日時の降順（最新順）で表示

### 4. 権限制御

#### 4.1 管理者のみ可能な操作

- 他ユーザーの予約キャンセル
- 全予約の一覧表示
- キャンセル履歴の確認
- 管理パネルへのアクセス

#### 4.2 セキュリティ機能

**監査ログ**
- すべての管理者操作が記録される
- 変更不可能な監査証跡
- セキュリティコンテキスト情報を含む

**アクセス制御**
- 管理者ロール以外はアクセス拒否
- 権限チェックはフロントエンドとバックエンド両方で実施

## エラーハンドリング

### よくあるエラーと対処法

**1. 「アクセス拒否」エラー**
- 原因：管理者権限がない
- 対処：管理者アカウントでログインし直す

**2. 「予約が見つかりません」エラー**
- 原因：予約が削除済み、または存在しない
- 対処：予約一覧を更新して最新状態を確認

**3. 「既にキャンセルされています」エラー**
- 原因：他の管理者が先にキャンセル済み
- 対処：予約一覧を更新して最新状態を確認

**4. ネットワークエラー**
- 原因：API接続エラー
- 対処：ページを再読み込み、システム管理者に連絡

## 操作時の注意事項

1. **キャンセル操作の取り消し不可**
   - 一度キャンセルした予約は復旧できません
   - 操作前に十分確認してください

2. **監査証跡の重要性**
   - すべての操作が記録されます
   - 不正な操作は検出されます

3. **管理者責任**
   - 他ユーザーの予約をキャンセルする際は、事前に当事者に連絡することを推奨します
   - 緊急時以外は予約者の同意を得てから操作してください

4. **セキュリティ**
   - 管理者権限の共有は禁止
   - 作業終了後は必ずログアウトしてください

## トラブルシューティング

### パフォーマンス問題

**大量データの表示が遅い場合**
- 検索条件を絞り込んで使用
- 期間フィルターを活用

**同時操作での競合**
- 他の管理者と同時操作した場合はエラーメッセージに従う
- 最新状態を確認してから再操作

### システム不具合の報告

以下の情報を含めてシステム管理者に報告：
- 発生時刻
- 操作手順
- エラーメッセージ
- 対象予約ID
- ブラウザ種類とバージョン

## 更新履歴

| バージョン | 日付 | 更新内容 |
|-----------|------|----------|
| 1.0 | 2025-09-04 | 初版作成 |

---

**重要**: このマニュアルは管理者専用です。一般ユーザーには公開しないでください。