<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.example.sales.domain.repository.SalesDetailMapper">

    <!-- ResultMap定義 -->
    <resultMap id="salesDetailResultMap" type="com.example.sales.domain.model.SalesDetail">
        <id property="salesNo" column="売上番号"/>
        <id property="salesRowNo" column="売上行番号"/>
        <result property="productCode" column="商品コード"/>
        <result property="productName" column="商品名"/>
        <result property="unitPrice" column="販売単価"/>
        <result property="shippedQuantity" column="出荷数量"/>
        <result property="salesQuantity" column="売上数量"/>
        <result property="discount" column="値引金額"/>
        <result property="invoiceDate" column="請求日"/>
        <result property="invoiceNo" column="請求番号"/>
        <result property="invoiceDelayDivision" column="請求遅延区分"/>
        <result property="autoJournalDate" column="自動仕訳日"/>
        <result property="createdAt" column="作成日時"/>
        <result property="createdBy" column="作成者名"/>
        <result property="updatedAt" column="更新日時"/>
        <result property="updatedBy" column="更新者名"/>
    </resultMap>

    <!-- INSERT -->
    <insert id="insert" parameterType="com.example.sales.domain.model.SalesDetail">
        INSERT INTO 売上データ明細 (
            売上番号,
            売上行番号,
            商品コード,
            商品名,
            販売単価,
            出荷数量,
            売上数量,
            値引金額,
            請求日,
            請求番号,
            請求遅延区分,
            自動仕訳日,
            作成者名,
            更新者名
        ) VALUES (
            #{salesNo},
            #{salesRowNo},
            #{productCode},
            #{productName},
            #{unitPrice},
            #{shippedQuantity},
            #{salesQuantity},
            #{discount},
            #{invoiceDate},
            #{invoiceNo},
            #{invoiceDelayDivision},
            #{autoJournalDate},
            #{createdBy},
            #{updatedBy}
        )
    </insert>

    <!-- UPDATE -->
    <update id="update" parameterType="com.example.sales.domain.model.SalesDetail">
        UPDATE 売上データ明細
        SET
            商品コード = #{productCode},
            商品名 = #{productName},
            販売単価 = #{unitPrice},
            出荷数量 = #{shippedQuantity},
            売上数量 = #{salesQuantity},
            値引金額 = #{discount},
            請求日 = #{invoiceDate},
            請求番号 = #{invoiceNo},
            請求遅延区分 = #{invoiceDelayDivision},
            自動仕訳日 = #{autoJournalDate},
            更新日時 = CURRENT_TIMESTAMP,
            更新者名 = #{updatedBy}
        WHERE
            売上番号 = #{salesNo}
            AND 売上行番号 = #{salesRowNo}
    </update>

    <!-- DELETE -->
    <delete id="delete">
        DELETE FROM 売上データ明細
        WHERE
            売上番号 = #{salesNo}
            AND 売上行番号 = #{salesRowNo}
    </delete>

    <!-- SELECT BY ID -->
    <select id="findById" resultMap="salesDetailResultMap">
        SELECT
            売上番号,
            売上行番号,
            商品コード,
            商品名,
            販売単価,
            出荷数量,
            売上数量,
            値引金額,
            請求日,
            請求番号,
            請求遅延区分,
            自動仕訳日,
            作成日時,
            作成者名,
            更新日時,
            更新者名
        FROM
            売上データ明細
        WHERE
            売上番号 = #{salesNo}
            AND 売上行番号 = #{salesRowNo}
    </select>

    <!-- SELECT BY SALES NO -->
    <select id="findBySalesNo" resultMap="salesDetailResultMap">
        SELECT
            売上番号,
            売上行番号,
            商品コード,
            商品名,
            販売単価,
            出荷数量,
            売上数量,
            値引金額,
            請求日,
            請求番号,
            請求遅延区分,
            自動仕訳日,
            作成日時,
            作成者名,
            更新日時,
            更新者名
        FROM
            売上データ明細
        WHERE
            売上番号 = #{salesNo}
        ORDER BY
            売上行番号
    </select>

    <!-- SELECT BY PRODUCT CODE -->
    <select id="findByProductCode" resultMap="salesDetailResultMap">
        SELECT
            売上番号,
            売上行番号,
            商品コード,
            商品名,
            販売単価,
            出荷数量,
            売上数量,
            値引金額,
            請求日,
            請求番号,
            請求遅延区分,
            自動仕訳日,
            作成日時,
            作成者名,
            更新日時,
            更新者名
        FROM
            売上データ明細
        WHERE
            商品コード = #{productCode}
        ORDER BY
            売上番号, 売上行番号
    </select>

    <!-- SELECT ALL -->
    <select id="findAll" resultMap="salesDetailResultMap">
        SELECT
            売上番号,
            売上行番号,
            商品コード,
            商品名,
            販売単価,
            出荷数量,
            売上数量,
            値引金額,
            請求日,
            請求番号,
            請求遅延区分,
            自動仕訳日,
            作成日時,
            作成者名,
            更新日時,
            更新者名
        FROM
            売上データ明細
        ORDER BY
            売上番号, 売上行番号
    </select>

</mapper>
