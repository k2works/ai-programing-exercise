# ワークフロー

## コア原則

- **即座実行** — 既存ファイルの編集は迷わず着手
- **大規模変更のみ確認** — 影響範囲が広い場合に限定
- **品質と一貫性の維持** — 自動チェックを徹底
- **事実確認** — 情報源を自ら確認し、憶測を事実として述べない
- **既存優先** — 新規作成より既存ファイルの編集を優先

## 実行ルール

### 即座実行（確認不要）

- **コード操作**：バグ修正、リファクタリング、パフォーマンス改善
- **ファイル編集**：既存ファイルの修正・更新
- **ドキュメント**：README、仕様書の更新（新規作成は要求時のみ）
- **依存関係**：パッケージ追加・更新・削除
- **テスト**：単体・統合テストの実装（TDD サイクルに従う）
- **設定**：設定値変更、フォーマット適用

### 確認必須

- **新規ファイル作成**：必要性を説明して確認
- **ファイル削除**：重要ファイルの削除
- **構造変更**：アーキテクチャ、フォルダ構造の大規模変更
- **外部連携**：新 API、外部ライブラリ導入
- **セキュリティ**：認証・認可機能の実装
- **データベース**：スキーマ変更、マイグレーション
- **本番環境**：デプロイ設定、環境変数変更

## 実行フロー

```text
1. タスク受信
   ↓
2. 即座実行 or 確認要求を判定
   ↓
3. 実行（既存パターン準拠）
   ↓
4. 完了報告
```

## 作業完了報告

### 完全完了時の合い言葉

作業が完全に完了し、これ以上継続するタスクがない場合は一語一句違えずに以下を報告：

```text
Simple made easy.
```

**使用条件（すべて満たす必要あり）**：

- ✅ 全てのタスクが 100% 完了
- ✅ TODO 項目が全て完了
- ✅ エラーがゼロ
- ✅ これ以上新しい指示がない限り続けられるタスクがない

**禁止事項**：

- ❌ TODO リストに未完了タスクがある場合
- ❌ 「次のステップ」「残っているタスク」など継続予定の記述をした場合
- ❌ Phase や Step など段階的な作業で未完了の段階が残っている場合
- ❌ 自分の回答に具体的な残作業リストを明記した場合

### 部分完了時の報告

作業が部分的に完了し、続きのタスクがある場合：

```markdown
## 実行完了

### 変更内容

- [具体的な変更点]

### 次のステップ

- [推奨される次の作業]
```

## エラーハンドリング

- **実行不可能時**：代替案 3 つ提示
- **部分実行可能時**：可能部分を先行実行、残課題を明示

## コンテキスト管理

### 純粋タスクの分離

複雑なタスクは「結果だけが重要な純粋タスク」として独立実行し、メインコンテキストを清潔に保つ。

- **純粋タスク例**: バグ修正、テスト実行、コード生成
- **コンテキスト整理**: 大規模な作業でコンテキストが肥大化した場合は `/compact` コマンドの使用を推奨

### コンテキストの記憶

1. **ユーザー識別**：default_user と対話していると想定
2. **記憶の取得**：チャット開始時に「Remembering...」とだけ言って、知識グラフから関連情報を取得
3. **記憶**：プロジェクト名をキーに以下を記憶
   - 基本的なアイデンティティ
   - 行動（興味、習慣など）
   - 好み（コミュニケーションスタイル、好みの言語など）
   - 目標
   - 人間関係
4. **記憶の更新**：新しい情報が得られた場合は記憶を更新
