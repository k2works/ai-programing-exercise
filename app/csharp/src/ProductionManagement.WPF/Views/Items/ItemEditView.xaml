<UserControl x:Class="ProductionManagement.WPF.Views.Items.ItemEditView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
             xmlns:vm="clr-namespace:ProductionManagement.WPF.ViewModels.Items"
             mc:Ignorable="d"
             d:DataContext="{d:DesignInstance Type=vm:ItemEditViewModel}"
             d:DesignHeight="600" d:DesignWidth="600">

    <Grid Margin="16">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- ヘッダー -->
        <DockPanel Grid.Row="0" Margin="0,0,0,24">
            <Button DockPanel.Dock="Left"
                    Command="{Binding CancelCommand}"
                    Style="{StaticResource MaterialDesignIconButton}"
                    ToolTip="戻る">
                <materialDesign:PackIcon Kind="ArrowLeft"/>
            </Button>
            <TextBlock Text="{Binding Title}"
                       Style="{StaticResource MaterialDesignHeadline5TextBlock}"
                       VerticalAlignment="Center"
                       Margin="8,0,0,0"/>
        </DockPanel>

        <!-- フォーム -->
        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
            <materialDesign:Card Padding="24">
                <StackPanel>
                    <!-- 品目コード -->
                    <TextBox materialDesign:HintAssist.Hint="品目コード *"
                             Text="{Binding ItemCode, UpdateSourceTrigger=PropertyChanged, ValidatesOnNotifyDataErrors=True}"
                             IsReadOnly="{Binding IsItemCodeReadOnly}"
                             MaxLength="20"
                             Margin="0,0,0,16"/>

                    <!-- 品名 -->
                    <TextBox materialDesign:HintAssist.Hint="品名 *"
                             Text="{Binding ItemName, UpdateSourceTrigger=PropertyChanged, ValidatesOnNotifyDataErrors=True}"
                             MaxLength="100"
                             Margin="0,0,0,16"/>

                    <!-- 品目区分 -->
                    <ComboBox materialDesign:HintAssist.Hint="品目区分 *"
                              ItemsSource="{Binding Categories}"
                              SelectedItem="{Binding Category, ValidatesOnNotifyDataErrors=True}"
                              Margin="0,0,0,16"/>

                    <Separator Margin="0,8,0,24"/>

                    <!-- 単位コード -->
                    <TextBox materialDesign:HintAssist.Hint="単位コード"
                             Text="{Binding UnitCode, UpdateSourceTrigger=PropertyChanged}"
                             Margin="0,0,0,16"/>

                    <!-- リードタイム -->
                    <TextBox materialDesign:HintAssist.Hint="リードタイム（日）"
                             Text="{Binding LeadTime, UpdateSourceTrigger=PropertyChanged, ValidatesOnNotifyDataErrors=True}"
                             Margin="0,0,0,16"/>

                    <!-- 安全リードタイム -->
                    <TextBox materialDesign:HintAssist.Hint="安全リードタイム（日）"
                             Text="{Binding SafetyLeadTime, UpdateSourceTrigger=PropertyChanged, ValidatesOnNotifyDataErrors=True}"
                             Margin="0,0,0,16"/>

                    <!-- 安全在庫 -->
                    <TextBox materialDesign:HintAssist.Hint="安全在庫"
                             Text="{Binding SafetyStock, UpdateSourceTrigger=PropertyChanged, ValidatesOnNotifyDataErrors=True}"
                             Margin="0,0,0,16"/>

                    <TextBlock Text="* は必須項目です"
                               Foreground="Gray"
                               FontSize="12"
                               Margin="0,8,0,0"/>
                </StackPanel>
            </materialDesign:Card>
        </ScrollViewer>

        <!-- ボタンエリア -->
        <Border Grid.Row="2" Padding="0,16,0,0">
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                <Button Content="キャンセル"
                        Command="{Binding CancelCommand}"
                        Style="{StaticResource MaterialDesignOutlinedButton}"
                        Margin="0,0,16,0"/>
                <Button Content="保存"
                        Command="{Binding SaveCommand}"
                        Style="{StaticResource MaterialDesignRaisedButton}">
                    <Button.ContentTemplate>
                        <DataTemplate>
                            <StackPanel Orientation="Horizontal">
                                <ProgressBar Style="{StaticResource MaterialDesignCircularProgressBar}"
                                             IsIndeterminate="True"
                                             Width="16" Height="16"
                                             Margin="0,0,8,0"
                                             Visibility="{Binding DataContext.IsSaving, RelativeSource={RelativeSource AncestorType=Button}, Converter={StaticResource BoolToVisibilityConverter}}"/>
                                <TextBlock Text="保存"/>
                            </StackPanel>
                        </DataTemplate>
                    </Button.ContentTemplate>
                </Button>
            </StackPanel>
        </Border>
    </Grid>
</UserControl>
