-- バブルソート（関数型スタイル）

-- 1回の「泡立ち」：リストを1回通して隣同士を比較・交換
泡立ち :: Ord a => [a] -> [a]
泡立ち []  = []
泡立ち [要素] = [要素]
泡立ち (左:右:残り)
    | 左 > 右   = 右 : 泡立ち (左:残り)  -- 交換して続ける
    | otherwise = 左 : 泡立ち (右:残り)  -- そのまま続ける

-- バブルソート本体：要素数-1回繰り返す
バブルソート :: Ord a => [a] -> [a]
バブルソート リスト =
    let 要素数 = length リスト
        繰り返し回数 = 要素数 - 1
    in iterate 泡立ち リスト !! 繰り返し回数

-- もっとわかりやすいバージョン
バブルソート簡単版 :: Ord a => [a] -> [a]
バブルソート簡単版 リスト =
    let 要素数 = length リスト
    in foldr (\_ 現在のリスト -> 泡立ち 現在のリスト) リスト [1..要素数 - 1]

-- テスト
main :: IO ()
main = do
    let 数字たち = [5, 3, 4, 1, 2]
    putStrLn $ "並べ替え前: " ++ show 数字たち
    putStrLn $ "並べ替え後: " ++ show (バブルソート 数字たち)
