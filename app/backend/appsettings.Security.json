{
  "Serilog": {
    "Using": ["Serilog.Sinks.Console", "Serilog.Sinks.File"],
    "MinimumLevel": {
      "Default": "Information",
      "Override": {
        "Microsoft": "Warning",
        "Microsoft.Hosting.Lifetime": "Information",
        "Microsoft.AspNetCore": "Warning",
        "System": "Warning"
      }
    },
    "WriteTo": [
      {
        "Name": "Console",
        "Args": {
          "formatter": "Serilog.Formatting.Compact.CompactJsonFormatter, Serilog.Formatting.Compact"
        }
      },
      {
        "Name": "File",
        "Args": {
          "path": "logs/mrs-.log",
          "formatter": "Serilog.Formatting.Compact.CompactJsonFormatter, Serilog.Formatting.Compact",
          "rollingInterval": "Day",
          "retainedFileCountLimit": 30,
          "buffered": true,
          "flushToDiskInterval": "00:00:05"
        }
      },
      {
        "Name": "File",
        "Args": {
          "path": "logs/security/security-.log",
          "restrictedToMinimumLevel": "Warning",
          "rollingInterval": "Day",
          "retainedFileCountLimit": 90,
          "outputTemplate": "{Timestamp:yyyy-MM-dd HH:mm:ss.fff zzz} [{Level:u3}] {Message:lj} {Properties:j}{NewLine}{Exception}"
        }
      },
      {
        "Name": "File",
        "Args": {
          "path": "logs/audit/audit-.log",
          "rollingInterval": "Day",
          "retainedFileCountLimit": 365,
          "outputTemplate": "{Timestamp:yyyy-MM-dd HH:mm:ss.fff zzz} [{Level:u3}] {Message:lj} {Properties:j}{NewLine}{Exception}",
          "buffered": false
        }
      },
      {
        "Name": "File",
        "Args": {
          "path": "logs/performance/performance-.log",
          "rollingInterval": "Day",
          "retainedFileCountLimit": 7,
          "outputTemplate": "{Timestamp:yyyy-MM-dd HH:mm:ss.fff zzz} [{Level:u3}] {Message:lj} {Properties:j}{NewLine}{Exception}",
          "restrictedToMinimumLevel": "Information"
        }
      }
    ],
    "Enrich": [
      "FromLogContext",
      "WithEnvironmentName",
      "WithMachineName",
      "WithProcessId",
      "WithThreadId"
    ],
    "Properties": {
      "ApplicationName": "MRS.Api",
      "ApplicationVersion": "1.0.0"
    }
  },
  "SecurityLogging": {
    "EnableDetailedLogging": true,
    "LogSensitiveData": false,
    "MaxLogSize": "100MB",
    "ArchiveOldLogs": true,
    "CompressionEnabled": true,
    "EncryptionEnabled": false,
    "AlertThresholds": {
      "FailedLoginsPerMinute": 10,
      "UnauthorizedAccessPerMinute": 5,
      "SecurityViolationsPerHour": 3
    }
  },
  "RateLimiting": {
    "GlobalLimits": {
      "RequestsPerMinute": 1000,
      "RequestsPerHour": 10000
    },
    "EndpointLimits": {
      "Login": {
        "RequestsPerMinute": 5,
        "BurstAllowance": 2
      },
      "Register": {
        "RequestsPerMinute": 3,
        "BurstAllowance": 1
      },
      "ReservationCreation": {
        "RequestsPerMinute": 10,
        "BurstAllowance": 5
      },
      "DataAccess": {
        "RequestsPerMinute": 100,
        "BurstAllowance": 20
      }
    },
    "IpWhitelist": [
      "127.0.0.1",
      "::1"
    ],
    "BlockedIps": [],
    "AutoBlockEnabled": true,
    "AutoBlockThreshold": 50,
    "AutoBlockDuration": "00:30:00"
  },
  "SecurityHeaders": {
    "EnableHSTS": true,
    "HSTSMaxAge": 31536000,
    "EnableCSP": true,
    "ContentSecurityPolicy": "default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src 'self' data:; connect-src 'self'",
    "EnableXContentTypeOptions": true,
    "EnableXFrameOptions": true,
    "XFrameOptions": "DENY",
    "EnableReferrerPolicy": true,
    "ReferrerPolicy": "strict-origin-when-cross-origin"
  },
  "DataProtection": {
    "ApplicationName": "MRS.Api",
    "KeyLifetime": "90.00:00:00",
    "MaxServerClockSkew": "00:05:00"
  },
  "AuditSettings": {
    "EnableAuditTrail": true,
    "AuditableEvents": [
      "Login",
      "Logout",
      "ReservationCreated",
      "ReservationCancelled",
      "ReservationUpdated",
      "UserCreated",
      "UserDeleted",
      "RoleChanged",
      "PasswordChanged",
      "DataAccess",
      "ConfigurationChanged"
    ],
    "RetentionPeriodDays": 2555,
    "CompressAfterDays": 90,
    "EncryptAuditLogs": true
  },
  "ThreatDetection": {
    "EnableBehavioralAnalysis": true,
    "SuspiciousPatterns": [
      {
        "Name": "SQLInjection",
        "Pattern": "(union\\s+select|drop\\s+table|delete\\s+from|insert\\s+into|update\\s+set)",
        "Severity": "High"
      },
      {
        "Name": "PathTraversal",
        "Pattern": "(\\.\\./|\\.\\\\|%2e%2e)",
        "Severity": "High"
      },
      {
        "Name": "XSS",
        "Pattern": "(<script|javascript:|onload=|onerror=)",
        "Severity": "Medium"
      },
      {
        "Name": "CommandInjection",
        "Pattern": "(;\\s*(cat|ls|dir|type)\\s|\\|\\s*(cat|ls|dir|type)\\s)",
        "Severity": "High"
      }
    ],
    "AutoResponse": {
      "EnableAutoBlock": true,
      "BlockDuration": "01:00:00",
      "NotifyAdmin": true,
      "CreateIncident": true
    }
  }
}