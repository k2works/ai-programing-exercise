name: å‹˜å®šç§‘ç›®ç®¡ç†ãƒ„ãƒ¼ãƒ«
description: è²¡å‹™ä¼šè¨ˆã‚·ã‚¹ãƒ†ãƒ ã®å‹˜å®šç§‘ç›®ãƒã‚¹ã‚¿ã‚’ç®¡ç†ã™ã‚‹ãƒ„ãƒ¼ãƒ«ï¼ˆè¤‡æ•°ä¸€æ‹¬å¯¾å¿œï¼‰
author: é–‹ç™ºãƒãƒ¼ãƒ 
host: EXCEL
api_set: {}
script:
  content: |
    const API_BASE_URL = 'http://localhost:8080';

    interface Account {
      accountCode: string;
      accountName: string;
      accountAbbr?: string;
      accountKana?: string;
      bsplType: string;
      debitCreditType?: string;
      elementType?: string;
      displayOrder?: number;
    }

    class AccountAPI {
      private baseUrl: string;

      constructor(baseUrl: string = API_BASE_URL) {
        this.baseUrl = baseUrl;
      }

      private async request<T>(method: string, path: string, body?: any): Promise<T> {
        const url = `${this.baseUrl}${path}`;
        const options: RequestInit = {
          method,
          headers: {
            'Content-Type': 'application/json',
            'Accept': 'application/json'
          }
        };

        if (body) {
          options.body = JSON.stringify(body);
        }

        try {
          const response = await fetch(url, options);

          if (!response.ok) {
            const error = await response.text();
            throw new Error(`API Error: ${response.status} - ${error}`);
          }

          if (response.status === 204) {
            return null as T;
          }

          return await response.json();
        } catch (error) {
          console.error('API Request Failed:', error);
          throw error;
        }
      }

      async getAllAccounts(): Promise<Account[]> {
        return this.request<Account[]>('GET', '/api/v1/accounts');
      }

      async getAccount(accountCode: string): Promise<Account> {
        return this.request<Account>('GET', `/api/v1/accounts/${accountCode}`);
      }

      async createAccount(account: Account): Promise<Account> {
        return this.request<Account>('POST', '/api/v1/accounts', account);
      }

      async updateAccount(accountCode: string, account: Account): Promise<Account> {
        return this.request<Account>('PUT', `/api/v1/accounts/${accountCode}`, account);
      }

      async deleteAccount(accountCode: string): Promise<void> {
        return this.request<void>('DELETE', `/api/v1/accounts/${accountCode}`);
      }
    }

    const api = new AccountAPI();

    // ã‚·ãƒ¼ãƒˆåå®šæ•°
    const SHEET_NAMES = {
      LIST: "å‹˜å®šç§‘ç›®ä¸€è¦§",
      REGISTER: "å‹˜å®šç§‘ç›®ç™»éŒ²"
    };

    /**
     * å‹˜å®šç§‘ç›®ä¸€è¦§ã‚·ãƒ¼ãƒˆã‚’ä½œæˆãƒ»æ›´æ–°
     */
    async function loadAccountsList() {
      try {
        await Excel.run(async (context) => {
          const workbook = context.workbook;
          workbook.worksheets.load("items/name");
          await context.sync();

          // ã‚·ãƒ¼ãƒˆã‚’å–å¾—ã¾ãŸã¯ä½œæˆ
          let sheet: Excel.Worksheet;
          const existingSheet = workbook.worksheets.items.find(s => s.name === SHEET_NAMES.LIST);

          if (existingSheet) {
            sheet = workbook.worksheets.getItem(SHEET_NAMES.LIST);
            // æ—¢å­˜ã®ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¯ãƒªã‚¢
            try {
              const usedRange = sheet.getUsedRange();
              usedRange.clear();
              await context.sync();
            } catch {
              // ç©ºã®ã‚·ãƒ¼ãƒˆã®å ´åˆã¯ã‚¯ãƒªã‚¢ä¸è¦
            }
          } else {
            sheet = workbook.worksheets.add(SHEET_NAMES.LIST);
          }

          // ã‚·ãƒ¼ãƒˆã‚’ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã«
          sheet.activate();

          // APIã‹ã‚‰å‹˜å®šç§‘ç›®ä¸€è¦§ã‚’å–å¾—
          const accounts = await api.getAllAccounts();

          // ãƒ˜ãƒƒãƒ€ãƒ¼è¡Œ
          const headers = [
            ["ç§‘ç›®ã‚³ãƒ¼ãƒ‰", "ç§‘ç›®å", "ç•¥ç§°", "ã‚«ãƒŠ", "BS/PL", "å€Ÿè²¸", "è¦ç´ ", "è¡¨ç¤ºé †"]
          ];

          // ãƒ‡ãƒ¼ã‚¿è¡Œ
          const data = accounts.map(account => [
            account.accountCode,
            account.accountName,
            account.accountAbbr || "",
            account.accountKana || "",
            account.bsplType,
            account.debitCreditType || "",
            account.elementType || "",
            account.displayOrder || ""
          ]);

          const allData = [...headers, ...data];

          // A1ã‹ã‚‰æ›¸ãè¾¼ã¿
          const range = sheet.getRange("A1").getResizedRange(allData.length - 1, headers[0].length - 1);
          range.values = allData;

          // ãƒ˜ãƒƒãƒ€ãƒ¼è¡Œã®æ›¸å¼è¨­å®š
          const headerRange = sheet.getRange("A1").getResizedRange(0, headers[0].length - 1);
          headerRange.format.fill.color = "#4472C4";
          headerRange.format.font.color = "white";
          headerRange.format.font.bold = true;

          // åˆ—å¹…ã‚’è‡ªå‹•èª¿æ•´
          range.format.autofitColumns();

          // ãƒ†ãƒ¼ãƒ–ãƒ«ã¨ã—ã¦æ›¸å¼è¨­å®š
          try {
            // æ—¢å­˜ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’å‰Šé™¤
            sheet.tables.load("items");
            await context.sync();

            for (const table of sheet.tables.items) {
              table.delete();
            }
            await context.sync();
          } catch {
            // ãƒ†ãƒ¼ãƒ–ãƒ«ãŒãªã„å ´åˆã¯ç„¡è¦–
          }

          const table = sheet.tables.add(range, true);
          table.name = "AccountListTable";
          table.style = "TableStyleMedium2";

          await context.sync();

          console.log(`${accounts.length}ä»¶ã®å‹˜å®šç§‘ç›®ã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ`);
          alert(`${accounts.length}ä»¶ã®å‹˜å®šç§‘ç›®ã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ`);
        });
      } catch (error) {
        console.error("ã‚¨ãƒ©ãƒ¼:", error);
        alert(`ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: ${error.message}`);
      }
    }

    /**
     * å‹˜å®šç§‘ç›®ç™»éŒ²ã‚·ãƒ¼ãƒˆã‚’ä½œæˆ
     */
    async function createRegisterSheet() {
      try {
        await Excel.run(async (context) => {
          const workbook = context.workbook;
          workbook.worksheets.load("items/name");
          await context.sync();

          // ã‚·ãƒ¼ãƒˆã‚’å–å¾—ã¾ãŸã¯ä½œæˆ
          let sheet: Excel.Worksheet;
          const existingSheet = workbook.worksheets.items.find(s => s.name === SHEET_NAMES.REGISTER);

          if (existingSheet) {
            sheet = workbook.worksheets.getItem(SHEET_NAMES.REGISTER);
            // æ—¢å­˜ã®ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¯ãƒªã‚¢
            try {
              const usedRange = sheet.getUsedRange();
              usedRange.clear();
              await context.sync();
            } catch {
              // ç©ºã®ã‚·ãƒ¼ãƒˆã®å ´åˆã¯ã‚¯ãƒªã‚¢ä¸è¦
            }
          } else {
            sheet = workbook.worksheets.add(SHEET_NAMES.REGISTER);
          }

          // ã‚·ãƒ¼ãƒˆã‚’ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã«
          sheet.activate();

          // ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ˜ãƒƒãƒ€ãƒ¼
          const headers = [
            ["ç§‘ç›®ã‚³ãƒ¼ãƒ‰", "ç§‘ç›®å", "ç•¥ç§°", "ã‚«ãƒŠ", "BS/PL", "å€Ÿè²¸", "è¦ç´ ", "è¡¨ç¤ºé †"]
          ];

          // ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ï¼ˆ3è¡Œï¼‰
          const sampleData = [
            ["", "", "", "", "", "", "", ""],
            ["", "", "", "", "", "", "", ""],
            ["", "", "", "", "", "", "", ""]
          ];

          const allData = [...headers, ...sampleData];

          // A1ã‹ã‚‰æ›¸ãè¾¼ã¿
          const range = sheet.getRange("A1").getResizedRange(allData.length - 1, headers[0].length - 1);
          range.values = allData;

          // ãƒ˜ãƒƒãƒ€ãƒ¼è¡Œã®æ›¸å¼è¨­å®š
          const headerRange = sheet.getRange("A1").getResizedRange(0, headers[0].length - 1);
          headerRange.format.fill.color = "#70AD47";
          headerRange.format.font.color = "white";
          headerRange.format.font.bold = true;

          // åˆ—å¹…ã‚’è‡ªå‹•èª¿æ•´
          range.format.autofitColumns();

          // èª¬æ˜ã‚’è¿½åŠ 
          const instructionRange = sheet.getRange("J1:J10");
          const instructions = [
            ["ã€ä½¿ã„æ–¹ã€‘"],
            ["1. ä¸‹ã®è¡Œã«å‹˜å®šç§‘ç›®ãƒ‡ãƒ¼ã‚¿ã‚’å…¥åŠ›"],
            ["2. å¿…é ˆé …ç›®ï¼šç§‘ç›®ã‚³ãƒ¼ãƒ‰ã€ç§‘ç›®åã€BS/PL"],
            ["3. BS/PL: Bï¼ˆè²¸å€Ÿå¯¾ç…§è¡¨ï¼‰ã¾ãŸã¯Pï¼ˆæç›Šè¨ˆç®—æ›¸ï¼‰"],
            ["4. å€Ÿè²¸: å€Ÿ ã¾ãŸã¯ è²¸"],
            ["5. ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦å®Ÿè¡Œ"],
            [""],
            ["ã€ä¸€æ‹¬ç™»éŒ²ã€‘æ–°è¦ãƒ‡ãƒ¼ã‚¿ã‚’è¤‡æ•°è¡Œç™»éŒ²"],
            ["ã€ä¸€æ‹¬æ›´æ–°ã€‘æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã‚’è¤‡æ•°è¡Œæ›´æ–°"],
            ["ã€ä¸€æ‹¬å‰Šé™¤ã€‘ç§‘ç›®ã‚³ãƒ¼ãƒ‰ã§è¤‡æ•°è¡Œå‰Šé™¤"]
          ];
          instructionRange.values = instructions;
          instructionRange.format.fill.color = "#FFF2CC";

          await context.sync();

          console.log("ç™»éŒ²ã‚·ãƒ¼ãƒˆã‚’ä½œæˆã—ã¾ã—ãŸ");
          alert("ç™»éŒ²ã‚·ãƒ¼ãƒˆã‚’ä½œæˆã—ã¾ã—ãŸ");
        });
      } catch (error) {
        console.error("ã‚¨ãƒ©ãƒ¼:", error);
        alert(`ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: ${error.message}`);
      }
    }

    /**
     * ç™»éŒ²ã‚·ãƒ¼ãƒˆã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿
     */
    async function readRegisterSheet(): Promise<Account[]> {
      return await Excel.run(async (context) => {
        const sheet = context.workbook.worksheets.getItem(SHEET_NAMES.REGISTER);

        // ãƒ‡ãƒ¼ã‚¿ç¯„å›²ã‚’å–å¾—ï¼ˆãƒ˜ãƒƒãƒ€ãƒ¼é™¤ãã€A2ã‹ã‚‰é–‹å§‹ï¼‰
        const dataRange = sheet.getRange("A2:H100");
        dataRange.load("values");
        await context.sync();

        const accounts: Account[] = [];
        for (const row of dataRange.values) {
          const accountCode = row[0] as string;

          // ç§‘ç›®ã‚³ãƒ¼ãƒ‰ãŒç©ºã®è¡Œã¯ã‚¹ã‚­ãƒƒãƒ—
          if (!accountCode || accountCode.trim() === "") {
            continue;
          }

          const account: Account = {
            accountCode: accountCode.trim(),
            accountName: (row[1] as string)?.trim() || "",
            accountAbbr: (row[2] as string)?.trim() || undefined,
            accountKana: (row[3] as string)?.trim() || undefined,
            bsplType: (row[4] as string)?.trim() || "",
            debitCreditType: (row[5] as string)?.trim() || undefined,
            elementType: (row[6] as string)?.trim() || undefined,
            displayOrder: row[7] ? parseInt(row[7] as string) : undefined
          };

          // å¿…é ˆé …ç›®ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
          if (!account.accountCode || !account.accountName || !account.bsplType) {
            throw new Error(`è¡Œãƒ‡ãƒ¼ã‚¿ãŒä¸æ­£ã§ã™: ç§‘ç›®ã‚³ãƒ¼ãƒ‰=${account.accountCode}`);
          }

          accounts.push(account);
        }

        return accounts;
      });
    }

    /**
     * ä¸€æ‹¬ç™»éŒ²
     */
    async function bulkCreate() {
      try {
        const accounts = await readRegisterSheet();

        if (accounts.length === 0) {
          alert("ç™»éŒ²ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“");
          return;
        }

        if (!confirm(`${accounts.length}ä»¶ã®å‹˜å®šç§‘ç›®ã‚’ç™»éŒ²ã—ã¾ã™ã‹ï¼Ÿ`)) {
          return;
        }

        let successCount = 0;
        let errorCount = 0;
        const errors: string[] = [];

        for (const account of accounts) {
          try {
            await api.createAccount(account);
            successCount++;
          } catch (error) {
            errorCount++;
            errors.push(`${account.accountCode}: ${error.message}`);
          }
        }

        let message = `ç™»éŒ²å®Œäº†\næˆåŠŸ: ${successCount}ä»¶\nå¤±æ•—: ${errorCount}ä»¶`;
        if (errors.length > 0) {
          message += "\n\nã‚¨ãƒ©ãƒ¼è©³ç´°:\n" + errors.slice(0, 5).join("\n");
          if (errors.length > 5) {
            message += `\n... ä»–${errors.length - 5}ä»¶`;
          }
        }

        console.log(message);
        alert(message);

        // ä¸€è¦§ã‚’å†èª­ã¿è¾¼ã¿
        if (successCount > 0) {
          await loadAccountsList();
        }
      } catch (error) {
        console.error("ã‚¨ãƒ©ãƒ¼:", error);
        alert(`ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: ${error.message}`);
      }
    }

    /**
     * ä¸€æ‹¬æ›´æ–°
     */
    async function bulkUpdate() {
      try {
        const accounts = await readRegisterSheet();

        if (accounts.length === 0) {
          alert("æ›´æ–°ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“");
          return;
        }

        if (!confirm(`${accounts.length}ä»¶ã®å‹˜å®šç§‘ç›®ã‚’æ›´æ–°ã—ã¾ã™ã‹ï¼Ÿ`)) {
          return;
        }

        let successCount = 0;
        let errorCount = 0;
        const errors: string[] = [];

        for (const account of accounts) {
          try {
            await api.updateAccount(account.accountCode, account);
            successCount++;
          } catch (error) {
            errorCount++;
            errors.push(`${account.accountCode}: ${error.message}`);
          }
        }

        let message = `æ›´æ–°å®Œäº†\næˆåŠŸ: ${successCount}ä»¶\nå¤±æ•—: ${errorCount}ä»¶`;
        if (errors.length > 0) {
          message += "\n\nã‚¨ãƒ©ãƒ¼è©³ç´°:\n" + errors.slice(0, 5).join("\n");
          if (errors.length > 5) {
            message += `\n... ä»–${errors.length - 5}ä»¶`;
          }
        }

        console.log(message);
        alert(message);

        // ä¸€è¦§ã‚’å†èª­ã¿è¾¼ã¿
        if (successCount > 0) {
          await loadAccountsList();
        }
      } catch (error) {
        console.error("ã‚¨ãƒ©ãƒ¼:", error);
        alert(`ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: ${error.message}`);
      }
    }

    /**
     * ä¸€æ‹¬å‰Šé™¤
     */
    async function bulkDelete() {
      try {
        const accounts = await readRegisterSheet();

        if (accounts.length === 0) {
          alert("å‰Šé™¤ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“");
          return;
        }

        const accountCodes = accounts.map(a => a.accountCode).join(", ");
        if (!confirm(`ä»¥ä¸‹ã®${accounts.length}ä»¶ã®å‹˜å®šç§‘ç›®ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ\n\n${accountCodes}`)) {
          return;
        }

        let successCount = 0;
        let errorCount = 0;
        const errors: string[] = [];

        for (const account of accounts) {
          try {
            await api.deleteAccount(account.accountCode);
            successCount++;
          } catch (error) {
            errorCount++;
            errors.push(`${account.accountCode}: ${error.message}`);
          }
        }

        let message = `å‰Šé™¤å®Œäº†\næˆåŠŸ: ${successCount}ä»¶\nå¤±æ•—: ${errorCount}ä»¶`;
        if (errors.length > 0) {
          message += "\n\nã‚¨ãƒ©ãƒ¼è©³ç´°:\n" + errors.slice(0, 5).join("\n");
          if (errors.length > 5) {
            message += `\n... ä»–${errors.length - 5}ä»¶`;
          }
        }

        console.log(message);
        alert(message);

        // ä¸€è¦§ã‚’å†èª­ã¿è¾¼ã¿
        if (successCount > 0) {
          await loadAccountsList();
        }
      } catch (error) {
        console.error("ã‚¨ãƒ©ãƒ¼:", error);
        alert(`ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: ${error.message}`);
      }
    }

    // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã®ç™»éŒ²
    Office.onReady(() => {
      document.getElementById("load-list")?.addEventListener("click", loadAccountsList);
      document.getElementById("create-register-sheet")?.addEventListener("click", createRegisterSheet);
      document.getElementById("bulk-create")?.addEventListener("click", bulkCreate);
      document.getElementById("bulk-update")?.addEventListener("click", bulkUpdate);
      document.getElementById("bulk-delete")?.addEventListener("click", bulkDelete);
    });
  language: typescript
template:
  content: |
    <div class="ms-welcome">
      <header class="ms-welcome__header ms-bgColor-themePrimary">
        <h1 class="ms-font-xxl ms-fontColor-white">å‹˜å®šç§‘ç›®ç®¡ç†</h1>
        <p class="ms-font-m ms-fontColor-white">ä¸€æ‹¬ç™»éŒ²ãƒ»æ›´æ–°ãƒ»å‰Šé™¤å¯¾å¿œ</p>
      </header>

      <main class="ms-welcome__main">
        <section class="ms-welcome__features">
          <h2 class="ms-font-xl">æ“ä½œæ–¹æ³•</h2>

          <div class="instruction-section">
            <h3 class="ms-font-l">1. å‹˜å®šç§‘ç›®ä¸€è¦§ã®è¡¨ç¤º</h3>
            <p>ç™»éŒ²ã•ã‚Œã¦ã„ã‚‹ã™ã¹ã¦ã®å‹˜å®šç§‘ç›®ã‚’ã€Œå‹˜å®šç§‘ç›®ä¸€è¦§ã€ã‚·ãƒ¼ãƒˆã«è¡¨ç¤ºã—ã¾ã™ã€‚</p>
            <button class="ms-Button ms-Button--primary" id="load-list">
              <span class="ms-Button-label">ğŸ“‹ ä¸€è¦§è¡¨ç¤º</span>
            </button>
          </div>

          <div class="instruction-section">
            <h3 class="ms-font-l">2. ç™»éŒ²ã‚·ãƒ¼ãƒˆã®ä½œæˆ</h3>
            <p>ã€Œå‹˜å®šç§‘ç›®ç™»éŒ²ã€ã‚·ãƒ¼ãƒˆã‚’ä½œæˆã—ã€ãƒ‡ãƒ¼ã‚¿å…¥åŠ›ç”¨ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’è¡¨ç¤ºã—ã¾ã™ã€‚</p>
            <button class="ms-Button ms-Button--primary" id="create-register-sheet">
              <span class="ms-Button-label">ğŸ“ ç™»éŒ²ã‚·ãƒ¼ãƒˆä½œæˆ</span>
            </button>
          </div>

          <div class="instruction-section">
            <h3 class="ms-font-l">3. ãƒ‡ãƒ¼ã‚¿å…¥åŠ›</h3>
            <p>ã€Œå‹˜å®šç§‘ç›®ç™»éŒ²ã€ã‚·ãƒ¼ãƒˆã«ä»¥ä¸‹ã®é …ç›®ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ï¼š</p>
            <table class="input-table">
              <tr><th>åˆ—</th><th>é …ç›®</th><th>å¿…é ˆ</th><th>å‚™è€ƒ</th></tr>
              <tr><td>A</td><td>ç§‘ç›®ã‚³ãƒ¼ãƒ‰</td><td>âœ“</td><td>æœ€å¤§10æ–‡å­—</td></tr>
              <tr><td>B</td><td>ç§‘ç›®å</td><td>âœ“</td><td>æœ€å¤§40æ–‡å­—</td></tr>
              <tr><td>C</td><td>ç•¥ç§°</td><td></td><td>æœ€å¤§20æ–‡å­—</td></tr>
              <tr><td>D</td><td>ã‚«ãƒŠ</td><td></td><td>æœ€å¤§40æ–‡å­—</td></tr>
              <tr><td>E</td><td>BS/PLåŒºåˆ†</td><td>âœ“</td><td>B or P</td></tr>
              <tr><td>F</td><td>å€Ÿè²¸åŒºåˆ†</td><td></td><td>å€Ÿ or è²¸</td></tr>
              <tr><td>G</td><td>è¦ç´ åŒºåˆ†</td><td></td><td>æœ€å¤§10æ–‡å­—</td></tr>
              <tr><td>H</td><td>è¡¨ç¤ºé †</td><td></td><td>æ•°å€¤</td></tr>
            </table>
            <p class="note">â€» è¤‡æ•°è¡Œã¾ã¨ã‚ã¦å…¥åŠ›ã§ãã¾ã™ï¼ˆæœ€å¤§99è¡Œï¼‰</p>
          </div>

          <div class="instruction-section">
            <h3 class="ms-font-l">4. ä¸€æ‹¬æ“ä½œã®å®Ÿè¡Œ</h3>
            <div class="button-group">
              <button class="ms-Button ms-Button--hero" id="bulk-create">
                <span class="ms-Button-label">â• ä¸€æ‹¬ç™»éŒ²</span>
              </button>
              <button class="ms-Button ms-Button--hero" id="bulk-update">
                <span class="ms-Button-label">ğŸ”„ ä¸€æ‹¬æ›´æ–°</span>
              </button>
            </div>
          </div>

          <div class="instruction-section danger">
            <h3 class="ms-font-l">5. ä¸€æ‹¬å‰Šé™¤</h3>
            <p>âš ï¸ ç§‘ç›®ã‚³ãƒ¼ãƒ‰åˆ—ï¼ˆAåˆ—ï¼‰ã«å‰Šé™¤ã—ãŸã„ç§‘ç›®ã‚³ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚</p>
            <button class="ms-Button ms-Button--danger" id="bulk-delete">
              <span class="ms-Button-label">ğŸ—‘ï¸ ä¸€æ‹¬å‰Šé™¤</span>
            </button>
          </div>

          <div class="info-section">
            <h3 class="ms-font-l">æ³¨æ„äº‹é …</h3>
            <ul>
              <li>APIã‚µãƒ¼ãƒãƒ¼ãŒ http://localhost:8080 ã§èµ·å‹•ã—ã¦ã„ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™</li>
              <li>å¿…é ˆé …ç›®ï¼šç§‘ç›®ã‚³ãƒ¼ãƒ‰ã€ç§‘ç›®åã€BS/PLåŒºåˆ†</li>
              <li>BS/PLåŒºåˆ†ã¯ã€ŒBã€ï¼ˆè²¸å€Ÿå¯¾ç…§è¡¨ï¼‰ã¾ãŸã¯ã€ŒPã€ï¼ˆæç›Šè¨ˆç®—æ›¸ï¼‰</li>
              <li>å€Ÿè²¸åŒºåˆ†ã¯ã€Œå€Ÿã€ã¾ãŸã¯ã€Œè²¸ã€</li>
              <li>ä¸€æ‹¬æ“ä½œã¯ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¦ã‚‚å‡¦ç†ã‚’ç¶™ç¶šã—ã¾ã™</li>
              <li>å‡¦ç†å®Œäº†å¾Œã«ã‚¨ãƒ©ãƒ¼ã‚µãƒãƒªãƒ¼ãŒè¡¨ç¤ºã•ã‚Œã¾ã™</li>
            </ul>
          </div>
        </section>
      </main>
    </div>
  language: html
style:
  content: |
    .ms-welcome {
      display: flex;
      flex-direction: column;
      height: 100%;
    }

    .ms-welcome__header {
      min-height: 100px;
      padding: 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      background: linear-gradient(135deg, #4472C4 0%, #2952A3 100%);
    }

    .ms-welcome__header h1 {
      margin: 0;
      font-size: 24px;
    }

    .ms-welcome__header p {
      margin: 10px 0 0 0;
      font-size: 14px;
    }

    .ms-welcome__main {
      flex: 1;
      padding: 20px;
      overflow-y: auto;
    }

    .ms-welcome__features {
      max-width: 700px;
      margin: 0 auto;
    }

    .ms-welcome__features h2 {
      margin-top: 0;
      margin-bottom: 20px;
      padding-bottom: 10px;
      border-bottom: 2px solid #4472C4;
    }

    .instruction-section {
      margin-bottom: 25px;
      padding: 15px;
      background-color: #f3f2f1;
      border-radius: 8px;
      border-left: 4px solid #4472C4;
    }

    .instruction-section.danger {
      background-color: #fef0f0;
      border-left-color: #d32f2f;
    }

    .instruction-section h3 {
      margin-top: 0;
      margin-bottom: 10px;
      color: #4472C4;
      font-size: 16px;
    }

    .instruction-section.danger h3 {
      color: #d32f2f;
    }

    .instruction-section p {
      margin: 0 0 15px 0;
      line-height: 1.6;
    }

    .note {
      font-size: 12px;
      color: #666;
      font-style: italic;
    }

    .input-table {
      width: 100%;
      margin: 15px 0;
      border-collapse: collapse;
      font-size: 13px;
    }

    .input-table th,
    .input-table td {
      padding: 8px;
      border: 1px solid #ddd;
      text-align: left;
    }

    .input-table th {
      background-color: #4472C4;
      color: white;
      font-weight: bold;
    }

    .input-table tr:nth-child(even) {
      background-color: #f9f9f9;
    }

    .button-group {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      margin-top: 15px;
    }

    .ms-Button {
      width: 100%;
      height: 44px;
      font-size: 14px;
      margin-top: 10px;
      border-radius: 4px;
      transition: all 0.2s;
    }

    .button-group .ms-Button {
      margin-top: 0;
    }

    .ms-Button--primary {
      background-color: #4472C4;
      border-color: #4472C4;
      color: white;
    }

    .ms-Button--primary:hover {
      background-color: #365a9e;
      border-color: #365a9e;
      transform: translateY(-1px);
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }

    .ms-Button--hero {
      background-color: #70AD47;
      border-color: #70AD47;
      color: white;
      font-weight: bold;
    }

    .ms-Button--hero:hover {
      background-color: #5a8f38;
      border-color: #5a8f38;
      transform: translateY(-1px);
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }

    .ms-Button--danger {
      background-color: #d32f2f;
      border-color: #d32f2f;
      color: white;
      font-weight: bold;
    }

    .ms-Button--danger:hover {
      background-color: #b71c1c;
      border-color: #b71c1c;
      transform: translateY(-1px);
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }

    .info-section {
      margin-top: 30px;
      padding: 15px;
      background-color: #fff4ce;
      border-left: 4px solid #ffc107;
      border-radius: 8px;
    }

    .info-section h3 {
      margin-top: 0;
      margin-bottom: 10px;
      color: #856404;
    }

    .info-section ul {
      margin: 0;
      padding-left: 20px;
    }

    .info-section li {
      margin-bottom: 8px;
      line-height: 1.6;
      color: #856404;
    }
  language: css
libraries: |
  https://appsforoffice.microsoft.com/lib/1/hosted/office.js
  @types/office-js

  @microsoft/office-js-helpers@1.0.1/dist/office.helpers.min.js
  @microsoft/office-js-helpers@1.0.1/dist/office.helpers.d.ts

  core-js@2.4.1/client/core.min.js
  @types/core-js

  jquery@3.1.1
  @types/jquery@3.3.1
