name: ä»•è¨³ç®¡ç†ãƒ„ãƒ¼ãƒ«
description: è²¡å‹™ä¼šè¨ˆã‚·ã‚¹ãƒ†ãƒ ã®ä»•è¨³ã‚’ç®¡ç†ã™ã‚‹ãƒ„ãƒ¼ãƒ«ï¼ˆè¤‡æ•°ä¸€æ‹¬å¯¾å¿œï¼‰
author: é–‹ç™ºãƒãƒ¼ãƒ 
host: EXCEL
api_set: {}
script:
  content: |
    const API_BASE_URL = 'http://localhost:8080';

    interface JournalLine {
      debitCreditFlag: string;
      currencyCode?: string;
      exchangeRate?: string;
      departmentCode?: string;
      projectCode?: string;
      accountCode: string;
      subAccountCode?: string;
      amount: string;
      baseAmount?: string;
      taxType?: string;
      taxRate?: number;
      taxCalcType?: string;
      dueDate?: string;
      cashFlowFlag?: boolean;
      segmentCode?: string;
      offsetAccountCode?: string;
      offsetSubAccountCode?: string;
      noteCode?: string;
      noteContent?: string;
    }

    interface JournalEntry {
      lineNumber: number;
      description: string;
      lines: JournalLine[];
    }

    interface Journal {
      journalNo: string;
      journalDate: string;
      inputDate?: string;
      settlementFlag?: boolean;
      singleEntryFlag?: boolean;
      journalType?: number;
      recurringFlag?: boolean;
      employeeCode?: string;
      departmentCode?: string;
      redSlipFlag?: boolean;
      redBlackVoucherNo?: string;
      entries: JournalEntry[];
    }

    class JournalAPI {
      private baseUrl: string;

      constructor(baseUrl: string = API_BASE_URL) {
        this.baseUrl = baseUrl;
      }

      private async request<T>(method: string, path: string, body?: any): Promise<T> {
        const url = `${this.baseUrl}${path}`;
        const options: RequestInit = {
          method,
          headers: {
            'Content-Type': 'application/json',
            'Accept': 'application/json'
          }
        };

        if (body) {
          options.body = JSON.stringify(body);
        }

        try {
          const response = await fetch(url, options);

          if (!response.ok) {
            const error = await response.text();
            throw new Error(`API Error: ${response.status} - ${error}`);
          }

          if (response.status === 204) {
            return null as T;
          }

          return await response.json();
        } catch (error) {
          console.error('API Request Failed:', error);
          throw error;
        }
      }

      async getAllJournals(): Promise<Journal[]> {
        return this.request<Journal[]>('GET', '/api/v1/journals');
      }

      async getJournal(journalNo: string): Promise<Journal> {
        return this.request<Journal>('GET', `/api/v1/journals/${journalNo}`);
      }

      async createJournal(journal: Journal): Promise<Journal> {
        return this.request<Journal>('POST', '/api/v1/journals', journal);
      }

      async updateJournal(journalNo: string, journal: Journal): Promise<Journal> {
        return this.request<Journal>('PUT', `/api/v1/journals/${journalNo}`, journal);
      }

      async deleteJournal(journalNo: string): Promise<void> {
        return this.request<void>('DELETE', `/api/v1/journals/${journalNo}`);
      }
    }

    const api = new JournalAPI();

    // ã‚·ãƒ¼ãƒˆåå®šæ•°
    const SHEET_NAMES = {
      LIST: "ä»•è¨³ä¸€è¦§",
      REGISTER: "ä»•è¨³ç™»éŒ²"
    };

    /**
     * ä»•è¨³ä¸€è¦§ã‚·ãƒ¼ãƒˆã‚’ä½œæˆãƒ»æ›´æ–°
     */
    async function loadJournalsList() {
      try {
        await Excel.run(async (context) => {
          const workbook = context.workbook;
          workbook.worksheets.load("items/name");
          await context.sync();

          // ã‚·ãƒ¼ãƒˆã‚’å–å¾—ã¾ãŸã¯ä½œæˆ
          let sheet: Excel.Worksheet;
          const existingSheet = workbook.worksheets.items.find(s => s.name === SHEET_NAMES.LIST);

          if (existingSheet) {
            sheet = workbook.worksheets.getItem(SHEET_NAMES.LIST);
            // æ—¢å­˜ã®ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¯ãƒªã‚¢
            try {
              const usedRange = sheet.getUsedRange();
              usedRange.clear();
              await context.sync();
            } catch {
              // ç©ºã®ã‚·ãƒ¼ãƒˆã®å ´åˆã¯ã‚¯ãƒªã‚¢ä¸è¦
            }
          } else {
            sheet = workbook.worksheets.add(SHEET_NAMES.LIST);
          }

          // ã‚·ãƒ¼ãƒˆã‚’ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã«
          sheet.activate();

          // APIã‹ã‚‰ä»•è¨³ä¸€è¦§ã‚’å–å¾—
          const journals = await api.getAllJournals();

          // ãƒ˜ãƒƒãƒ€ãƒ¼è¡Œ
          const headers = [
            ["ä»•è¨³ç•ªå·", "ä»•è¨³æ—¥ä»˜", "å…¥åŠ›æ—¥ä»˜", "æ±ºç®—", "ä»•è¨³åŒºåˆ†", "æ˜ç´°æ•°", "å€Ÿæ–¹é‡‘é¡", "è²¸æ–¹é‡‘é¡"]
          ];

          // ãƒ‡ãƒ¼ã‚¿è¡Œ
          const data = journals.map(journal => {
            // å€Ÿæ–¹ãƒ»è²¸æ–¹ã®åˆè¨ˆã‚’è¨ˆç®—
            let debitTotal = 0;
            let creditTotal = 0;
            let entryCount = 0;

            if (journal.entries) {
              journal.entries.forEach(entry => {
                if (entry.lines) {
                  entry.lines.forEach(line => {
                    const amount = parseFloat(line.amount || "0");
                    if (line.debitCreditFlag === "å€Ÿ") {
                      debitTotal += amount;
                    } else if (line.debitCreditFlag === "è²¸") {
                      creditTotal += amount;
                    }
                  });
                  entryCount += entry.lines.length;
                }
              });
            }

            return [
              journal.journalNo,
              journal.journalDate,
              journal.inputDate || "",
              journal.settlementFlag ? "â—‹" : "",
              journal.journalType || "",
              entryCount,
              debitTotal,
              creditTotal
            ];
          });

          const allData = [...headers, ...data];

          // A1ã‹ã‚‰æ›¸ãè¾¼ã¿
          const range = sheet.getRange("A1").getResizedRange(allData.length - 1, headers[0].length - 1);
          range.values = allData;

          // ãƒ˜ãƒƒãƒ€ãƒ¼è¡Œã®æ›¸å¼è¨­å®š
          const headerRange = sheet.getRange("A1").getResizedRange(0, headers[0].length - 1);
          headerRange.format.fill.color = "#4472C4";
          headerRange.format.font.color = "white";
          headerRange.format.font.bold = true;

          // é‡‘é¡åˆ—ã®æ›¸å¼è¨­å®š
          if (data.length > 0) {
            const debitAmountRange = sheet.getRange(`G2:G${data.length + 1}`);
            const creditAmountRange = sheet.getRange(`H2:H${data.length + 1}`);
            debitAmountRange.numberFormat = [["#,##0"]];
            creditAmountRange.numberFormat = [["#,##0"]];
          }

          // åˆ—å¹…ã‚’è‡ªå‹•èª¿æ•´
          range.format.autofitColumns();

          // ãƒ†ãƒ¼ãƒ–ãƒ«ã¨ã—ã¦æ›¸å¼è¨­å®š
          try {
            // æ—¢å­˜ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’å‰Šé™¤
            sheet.tables.load("items");
            await context.sync();

            for (const table of sheet.tables.items) {
              table.delete();
            }
            await context.sync();
          } catch {
            // ãƒ†ãƒ¼ãƒ–ãƒ«ãŒãªã„å ´åˆã¯ç„¡è¦–
          }

          const table = sheet.tables.add(range, true);
          table.name = "JournalListTable";
          table.style = "TableStyleMedium2";

          await context.sync();

          console.log("========================================");
          console.log(`${journals.length}ä»¶ã®ä»•è¨³ã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ`);
          console.log("========================================");
        });
      } catch (error) {
        console.error("========================================");
        console.error("ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿ");
        console.error(error);
        console.error("========================================");
      }
    }

    /**
     * ä»•è¨³ç™»éŒ²ã‚·ãƒ¼ãƒˆã‚’ä½œæˆï¼ˆç°¡æ˜“æŒ¯æ›¿ä¼ç¥¨å½¢å¼ï¼‰
     */
    async function createRegisterSheet() {
      try {
        await Excel.run(async (context) => {
          const workbook = context.workbook;
          workbook.worksheets.load("items/name");
          await context.sync();

          // ã‚·ãƒ¼ãƒˆã‚’å–å¾—ã¾ãŸã¯ä½œæˆ
          let sheet: Excel.Worksheet;
          const existingSheet = workbook.worksheets.items.find(s => s.name === SHEET_NAMES.REGISTER);

          if (existingSheet) {
            sheet = workbook.worksheets.getItem(SHEET_NAMES.REGISTER);
            // æ—¢å­˜ã®ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¯ãƒªã‚¢
            try {
              const usedRange = sheet.getUsedRange();
              usedRange.clear();
              await context.sync();
            } catch {
              // ç©ºã®ã‚·ãƒ¼ãƒˆã®å ´åˆã¯ã‚¯ãƒªã‚¢ä¸è¦
            }
          } else {
            sheet = workbook.worksheets.add(SHEET_NAMES.REGISTER);
          }

          // ã‚·ãƒ¼ãƒˆã‚’ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã«
          sheet.activate();

          // ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ˜ãƒƒãƒ€ãƒ¼ï¼ˆç°¡æ˜“æŒ¯æ›¿ä¼ç¥¨å½¢å¼ï¼‰
          const headers = [
            ["ä»•è¨³ç•ªå·", "ä»•è¨³æ—¥ä»˜", "æ‘˜è¦", "å€Ÿæ–¹ç§‘ç›®", "å€Ÿæ–¹é‡‘é¡", "è²¸æ–¹ç§‘ç›®", "è²¸æ–¹é‡‘é¡"]
          ];

          // ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ï¼ˆ3è¡Œï¼‰
          const sampleData = [
            ["", "", "", "", "", "", ""],
            ["", "", "", "", "", "", ""],
            ["", "", "", "", "", "", ""]
          ];

          const allData = [...headers, ...sampleData];

          // A1ã‹ã‚‰æ›¸ãè¾¼ã¿
          const range = sheet.getRange("A1").getResizedRange(allData.length - 1, headers[0].length - 1);
          range.values = allData;

          // ãƒ˜ãƒƒãƒ€ãƒ¼è¡Œã®æ›¸å¼è¨­å®š
          const headerRange = sheet.getRange("A1").getResizedRange(0, headers[0].length - 1);
          headerRange.format.fill.color = "#70AD47";
          headerRange.format.font.color = "white";
          headerRange.format.font.bold = true;

          // åˆ—å¹…ã‚’è‡ªå‹•èª¿æ•´
          range.format.autofitColumns();

          // èª¬æ˜ã‚’è¿½åŠ 
          const instructionRange = sheet.getRange("I1:I15");
          const instructions = [
            ["ã€ä½¿ã„æ–¹ã€‘"],
            ["1. ä¸‹ã®è¡Œã«ä»•è¨³ãƒ‡ãƒ¼ã‚¿ã‚’å…¥åŠ›"],
            ["2. å¿…é ˆé …ç›®ï¼š"],
            ["   - ä»•è¨³ç•ªå·"],
            ["   - ä»•è¨³æ—¥ä»˜ï¼ˆYYYY-MM-DDå½¢å¼ï¼‰"],
            ["   - æ‘˜è¦"],
            ["   - å€Ÿæ–¹ç§‘ç›®ã‚³ãƒ¼ãƒ‰"],
            ["   - å€Ÿæ–¹é‡‘é¡"],
            ["   - è²¸æ–¹ç§‘ç›®ã‚³ãƒ¼ãƒ‰"],
            ["   - è²¸æ–¹é‡‘é¡"],
            [""],
            ["ã€æ³¨æ„ã€‘"],
            ["- ç°¡æ˜“æŒ¯æ›¿ä¼ç¥¨å½¢å¼ï¼ˆå€Ÿæ–¹1ç§‘ç›®ã€è²¸æ–¹1ç§‘ç›®ï¼‰"],
            ["- ä»•è¨³æ—¥ä»˜: 2021-04-01 å½¢å¼ã§å…¥åŠ›"],
            ["- é‡‘é¡: æ•°å€¤ã®ã¿ï¼ˆã‚«ãƒ³ãƒä¸è¦ï¼‰"]
          ];
          instructionRange.values = instructions;
          instructionRange.format.fill.color = "#FFF2CC";

          await context.sync();

          console.log("========================================");
          console.log("ç™»éŒ²ã‚·ãƒ¼ãƒˆã‚’ä½œæˆã—ã¾ã—ãŸ");
          console.log("========================================");
        });
      } catch (error) {
        console.error("========================================");
        console.error("ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿ");
        console.error(error);
        console.error("========================================");
      }
    }

    /**
     * ç™»éŒ²ã‚·ãƒ¼ãƒˆã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿ï¼ˆç°¡æ˜“æŒ¯æ›¿ä¼ç¥¨å½¢å¼ï¼‰
     */
    async function readRegisterSheet(): Promise<Journal[]> {
      return await Excel.run(async (context) => {
        const workbook = context.workbook;
        workbook.worksheets.load("items/name");
        await context.sync();

        // ã‚·ãƒ¼ãƒˆã®å­˜åœ¨ç¢ºèª
        const existingSheet = workbook.worksheets.items.find(s => s.name === SHEET_NAMES.REGISTER);
        if (!existingSheet) {
          throw new Error("ã€Œä»•è¨³ç™»éŒ²ã€ã‚·ãƒ¼ãƒˆãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚å…ˆã«ã€Œç™»éŒ²ã‚·ãƒ¼ãƒˆä½œæˆã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ãã ã•ã„ã€‚");
        }

        const sheet = context.workbook.worksheets.getItem(SHEET_NAMES.REGISTER);

        // ãƒ‡ãƒ¼ã‚¿ç¯„å›²ã‚’å–å¾—ï¼ˆãƒ˜ãƒƒãƒ€ãƒ¼é™¤ãã€A2ã‹ã‚‰é–‹å§‹ï¼‰
        const dataRange = sheet.getRange("A2:G100");
        dataRange.load("values");
        await context.sync();

        const journals: Journal[] = [];
        for (const row of dataRange.values) {
          // Excel ã®ã‚»ãƒ«å€¤ã‚’æ–‡å­—åˆ—ã«å¤‰æ›
          const journalNo = row[0] != null ? String(row[0]).trim() : "";

          // ä»•è¨³ç•ªå·ãŒç©ºã®è¡Œã¯ã‚¹ã‚­ãƒƒãƒ—
          if (!journalNo) {
            continue;
          }

          const journalDate = row[1] != null ? String(row[1]).trim() : "";
          const description = row[2] != null ? String(row[2]).trim() : "";
          const debitAccount = row[3] != null ? String(row[3]).trim() : "";
          const debitAmount = row[4] != null ? String(row[4]).trim() : "";
          const creditAccount = row[5] != null ? String(row[5]).trim() : "";
          const creditAmount = row[6] != null ? String(row[6]).trim() : "";

          // å¿…é ˆé …ç›®ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
          if (!journalNo || !journalDate || !description || !debitAccount || !debitAmount || !creditAccount || !creditAmount) {
            throw new Error(`è¡Œãƒ‡ãƒ¼ã‚¿ãŒä¸æ­£ã§ã™: ä»•è¨³ç•ªå·=${journalNo}`);
          }

          // ç°¡æ˜“æŒ¯æ›¿ä¼ç¥¨å½¢å¼ã®Journalã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆ
          const journal: Journal = {
            journalNo: journalNo,
            journalDate: journalDate,
            inputDate: journalDate,
            settlementFlag: false,
            singleEntryFlag: false,
            journalType: 1,
            recurringFlag: false,
            redSlipFlag: false,
            entries: [
              {
                lineNumber: 1,
                description: description,
                lines: [
                  {
                    debitCreditFlag: "å€Ÿ",
                    accountCode: debitAccount,
                    amount: debitAmount,
                    currencyCode: "JPY",
                    exchangeRate: "1.0",
                    cashFlowFlag: false
                  },
                  {
                    debitCreditFlag: "è²¸",
                    accountCode: creditAccount,
                    amount: creditAmount,
                    currencyCode: "JPY",
                    exchangeRate: "1.0",
                    cashFlowFlag: false
                  }
                ]
              }
            ]
          };

          journals.push(journal);
        }

        return journals;
      });
    }

    /**
     * ä¸€æ‹¬ç™»éŒ²
     */
    async function bulkCreate() {
      try {
        console.log("ä¸€æ‹¬ç™»éŒ²é–‹å§‹");
        const journals = await readRegisterSheet();
        console.log(`èª­ã¿è¾¼ã‚“ã ãƒ‡ãƒ¼ã‚¿: ${journals.length}ä»¶`);

        if (journals.length === 0) {
          console.log("ç™»éŒ²ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“");
          return;
        }

        console.log(`${journals.length}ä»¶ã®ä»•è¨³ã‚’ç™»éŒ²ã—ã¾ã™`);
        let successCount = 0;
        let errorCount = 0;
        const errors: string[] = [];

        for (const journal of journals) {
          try {
            console.log(`ç™»éŒ²ä¸­: ${journal.journalNo} - ${journal.journalDate}`);
            await api.createJournal(journal);
            successCount++;
            console.log(`æˆåŠŸ: ${journal.journalNo}`);
          } catch (error) {
            errorCount++;
            errors.push(`${journal.journalNo}: ${error.message}`);
          }
        }

        console.log("========================================");
        console.log("ç™»éŒ²å®Œäº†");
        console.log(`æˆåŠŸ: ${successCount}ä»¶`);
        console.log(`å¤±æ•—: ${errorCount}ä»¶`);
        if (errors.length > 0) {
          console.log("\nã‚¨ãƒ©ãƒ¼è©³ç´°:");
          errors.forEach(err => console.log(`  - ${err}`));
        }
        console.log("========================================");

        // ä¸€è¦§ã‚’å†èª­ã¿è¾¼ã¿
        if (successCount > 0) {
          await loadJournalsList();
        }
      } catch (error) {
        console.error("========================================");
        console.error("ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿ");
        console.error(error);
        console.error("========================================");
      }
    }

    /**
     * ä¸€æ‹¬æ›´æ–°
     */
    async function bulkUpdate() {
      try {
        console.log("ä¸€æ‹¬æ›´æ–°é–‹å§‹");
        const journals = await readRegisterSheet();
        console.log(`èª­ã¿è¾¼ã‚“ã ãƒ‡ãƒ¼ã‚¿: ${journals.length}ä»¶`);

        if (journals.length === 0) {
          console.log("æ›´æ–°ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“");
          return;
        }

        console.log(`${journals.length}ä»¶ã®ä»•è¨³ã‚’æ›´æ–°ã—ã¾ã™`);
        let successCount = 0;
        let errorCount = 0;
        const errors: string[] = [];

        for (const journal of journals) {
          try {
            console.log(`æ›´æ–°ä¸­: ${journal.journalNo} - ${journal.journalDate}`);
            await api.updateJournal(journal.journalNo, journal);
            successCount++;
            console.log(`æˆåŠŸ: ${journal.journalNo}`);
          } catch (error) {
            errorCount++;
            errors.push(`${journal.journalNo}: ${error.message}`);
          }
        }

        console.log("========================================");
        console.log("æ›´æ–°å®Œäº†");
        console.log(`æˆåŠŸ: ${successCount}ä»¶`);
        console.log(`å¤±æ•—: ${errorCount}ä»¶`);
        if (errors.length > 0) {
          console.log("\nã‚¨ãƒ©ãƒ¼è©³ç´°:");
          errors.forEach(err => console.log(`  - ${err}`));
        }
        console.log("========================================");

        // ä¸€è¦§ã‚’å†èª­ã¿è¾¼ã¿
        if (successCount > 0) {
          await loadJournalsList();
        }
      } catch (error) {
        console.error("========================================");
        console.error("ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿ");
        console.error(error);
        console.error("========================================");
      }
    }

    /**
     * ä¸€æ‹¬å‰Šé™¤
     */
    async function bulkDelete() {
      try {
        console.log("ä¸€æ‹¬å‰Šé™¤é–‹å§‹");
        const journals = await readRegisterSheet();
        console.log(`èª­ã¿è¾¼ã‚“ã ãƒ‡ãƒ¼ã‚¿: ${journals.length}ä»¶`);

        if (journals.length === 0) {
          console.log("å‰Šé™¤ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“");
          return;
        }

        const journalNos = journals.map(j => j.journalNo).join(", ");
        console.log(`ä»¥ä¸‹ã®${journals.length}ä»¶ã®ä»•è¨³ã‚’å‰Šé™¤ã—ã¾ã™: ${journalNos}`);
        let successCount = 0;
        let errorCount = 0;
        const errors: string[] = [];

        for (const journal of journals) {
          try {
            console.log(`å‰Šé™¤ä¸­: ${journal.journalNo}`);
            await api.deleteJournal(journal.journalNo);
            successCount++;
            console.log(`æˆåŠŸ: ${journal.journalNo}`);
          } catch (error) {
            errorCount++;
            errors.push(`${journal.journalNo}: ${error.message}`);
          }
        }

        console.log("========================================");
        console.log("å‰Šé™¤å®Œäº†");
        console.log(`æˆåŠŸ: ${successCount}ä»¶`);
        console.log(`å¤±æ•—: ${errorCount}ä»¶`);
        if (errors.length > 0) {
          console.log("\nã‚¨ãƒ©ãƒ¼è©³ç´°:");
          errors.forEach(err => console.log(`  - ${err}`));
        }
        console.log("========================================");

        // ä¸€è¦§ã‚’å†èª­ã¿è¾¼ã¿
        if (successCount > 0) {
          await loadJournalsList();
        }
      } catch (error) {
        console.error("========================================");
        console.error("ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿ");
        console.error(error);
        console.error("========================================");
      }
    }

    // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã®ç™»éŒ²
    Office.onReady(() => {
      console.log("Office.onReady - ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã‚’ç™»éŒ²ã—ã¾ã™");

      const loadListBtn = document.getElementById("load-list");
      const createSheetBtn = document.getElementById("create-register-sheet");
      const bulkCreateBtn = document.getElementById("bulk-create");
      const bulkUpdateBtn = document.getElementById("bulk-update");
      const bulkDeleteBtn = document.getElementById("bulk-delete");

      console.log("ãƒœã‚¿ãƒ³è¦ç´ :", {
        loadList: !!loadListBtn,
        createSheet: !!createSheetBtn,
        bulkCreate: !!bulkCreateBtn,
        bulkUpdate: !!bulkUpdateBtn,
        bulkDelete: !!bulkDeleteBtn
      });

      loadListBtn?.addEventListener("click", loadJournalsList);
      createSheetBtn?.addEventListener("click", createRegisterSheet);
      bulkCreateBtn?.addEventListener("click", bulkCreate);
      bulkUpdateBtn?.addEventListener("click", bulkUpdate);
      bulkDeleteBtn?.addEventListener("click", bulkDelete);

      console.log("ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ç™»éŒ²å®Œäº†");
    });
  language: typescript
template:
  content: |
    <div class="ms-welcome">
      <header class="ms-welcome__header ms-bgColor-themePrimary">
        <h1 class="ms-font-xxl ms-fontColor-white">ä»•è¨³ç®¡ç†</h1>
        <p class="ms-font-m ms-fontColor-white">ç°¡æ˜“æŒ¯æ›¿ä¼ç¥¨å½¢å¼ï¼ˆä¸€æ‹¬ç™»éŒ²ãƒ»æ›´æ–°ãƒ»å‰Šé™¤å¯¾å¿œï¼‰</p>
      </header>

      <main class="ms-welcome__main">
        <section class="ms-welcome__features">
          <h2 class="ms-font-xl">æ“ä½œæ–¹æ³•</h2>

          <div class="instruction-section">
            <h3 class="ms-font-l">1. ä»•è¨³ä¸€è¦§ã®è¡¨ç¤º</h3>
            <p>ç™»éŒ²ã•ã‚Œã¦ã„ã‚‹ã™ã¹ã¦ã®ä»•è¨³ã‚’ã€Œä»•è¨³ä¸€è¦§ã€ã‚·ãƒ¼ãƒˆã«è¡¨ç¤ºã—ã¾ã™ã€‚</p>
            <button class="ms-Button ms-Button--primary" id="load-list">
              <span class="ms-Button-label">ğŸ“‹ ä¸€è¦§è¡¨ç¤º</span>
            </button>
          </div>

          <div class="instruction-section">
            <h3 class="ms-font-l">2. ç™»éŒ²ã‚·ãƒ¼ãƒˆã®ä½œæˆ</h3>
            <p>ã€Œä»•è¨³ç™»éŒ²ã€ã‚·ãƒ¼ãƒˆã‚’ä½œæˆã—ã€ãƒ‡ãƒ¼ã‚¿å…¥åŠ›ç”¨ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’è¡¨ç¤ºã—ã¾ã™ã€‚</p>
            <button class="ms-Button ms-Button--primary" id="create-register-sheet">
              <span class="ms-Button-label">ğŸ“ ç™»éŒ²ã‚·ãƒ¼ãƒˆä½œæˆ</span>
            </button>
          </div>

          <div class="instruction-section">
            <h3 class="ms-font-l">3. ãƒ‡ãƒ¼ã‚¿å…¥åŠ›ï¼ˆç°¡æ˜“æŒ¯æ›¿ä¼ç¥¨å½¢å¼ï¼‰</h3>
            <p>ã€Œä»•è¨³ç™»éŒ²ã€ã‚·ãƒ¼ãƒˆã«ä»¥ä¸‹ã®é …ç›®ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ï¼š</p>
            <table class="input-table">
              <tr><th>åˆ—</th><th>é …ç›®</th><th>å¿…é ˆ</th><th>å‚™è€ƒ</th></tr>
              <tr><td>A</td><td>ä»•è¨³ç•ªå·</td><td>âœ“</td><td>ä¾‹: J001</td></tr>
              <tr><td>B</td><td>ä»•è¨³æ—¥ä»˜</td><td>âœ“</td><td>YYYY-MM-DDå½¢å¼</td></tr>
              <tr><td>C</td><td>æ‘˜è¦</td><td>âœ“</td><td>å–å¼•å†…å®¹</td></tr>
              <tr><td>D</td><td>å€Ÿæ–¹ç§‘ç›®ã‚³ãƒ¼ãƒ‰</td><td>âœ“</td><td>ä¾‹: 1111</td></tr>
              <tr><td>E</td><td>å€Ÿæ–¹é‡‘é¡</td><td>âœ“</td><td>æ•°å€¤ã®ã¿</td></tr>
              <tr><td>F</td><td>è²¸æ–¹ç§‘ç›®ã‚³ãƒ¼ãƒ‰</td><td>âœ“</td><td>ä¾‹: 4111</td></tr>
              <tr><td>G</td><td>è²¸æ–¹é‡‘é¡</td><td>âœ“</td><td>æ•°å€¤ã®ã¿</td></tr>
            </table>
            <p class="note">â€» è¤‡æ•°è¡Œã¾ã¨ã‚ã¦å…¥åŠ›ã§ãã¾ã™ï¼ˆæœ€å¤§99è¡Œï¼‰</p>
            <p class="note">â€» ç°¡æ˜“æŒ¯æ›¿ä¼ç¥¨å½¢å¼ï¼ˆå€Ÿæ–¹1ç§‘ç›®ã€è²¸æ–¹1ç§‘ç›®ã®ã‚·ãƒ³ãƒ—ãƒ«ãªä»•è¨³ã®ã¿å¯¾å¿œï¼‰</p>
          </div>

          <div class="instruction-section">
            <h3 class="ms-font-l">4. ä¸€æ‹¬æ“ä½œã®å®Ÿè¡Œ</h3>
            <div class="button-group">
              <button class="ms-Button ms-Button--hero" id="bulk-create">
                <span class="ms-Button-label">â• ä¸€æ‹¬ç™»éŒ²</span>
              </button>
              <button class="ms-Button ms-Button--hero" id="bulk-update">
                <span class="ms-Button-label">ğŸ”„ ä¸€æ‹¬æ›´æ–°</span>
              </button>
            </div>
          </div>

          <div class="instruction-section danger">
            <h3 class="ms-font-l">5. ä¸€æ‹¬å‰Šé™¤</h3>
            <p>âš ï¸ ä»•è¨³ç•ªå·åˆ—ï¼ˆAåˆ—ï¼‰ã«å‰Šé™¤ã—ãŸã„ä»•è¨³ç•ªå·ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚</p>
            <button class="ms-Button ms-Button--danger" id="bulk-delete">
              <span class="ms-Button-label">ğŸ—‘ï¸ ä¸€æ‹¬å‰Šé™¤</span>
            </button>
          </div>

          <div class="info-section">
            <h3 class="ms-font-l">æ³¨æ„äº‹é …</h3>
            <ul>
              <li>APIã‚µãƒ¼ãƒãƒ¼ãŒ http://localhost:8080 ã§èµ·å‹•ã—ã¦ã„ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™</li>
              <li>ç°¡æ˜“æŒ¯æ›¿ä¼ç¥¨å½¢å¼ï¼ˆå€Ÿæ–¹1ç§‘ç›®ã€è²¸æ–¹1ç§‘ç›®ï¼‰ã®ã¿å¯¾å¿œ</li>
              <li>ä»•è¨³æ—¥ä»˜ã¯ã€Œ2021-04-01ã€å½¢å¼ã§å…¥åŠ›ã—ã¦ãã ã•ã„</li>
              <li>é‡‘é¡ã¯æ•°å€¤ã®ã¿ï¼ˆã‚«ãƒ³ãƒä¸è¦ï¼‰ã§å…¥åŠ›ã—ã¦ãã ã•ã„</li>
              <li>å€Ÿæ–¹é‡‘é¡ã¨è²¸æ–¹é‡‘é¡ã¯å¿…ãšä¸€è‡´ã•ã›ã¦ãã ã•ã„</li>
              <li>ä¸€æ‹¬æ“ä½œã¯ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¦ã‚‚å‡¦ç†ã‚’ç¶™ç¶šã—ã¾ã™</li>
              <li>å‡¦ç†å®Œäº†å¾Œã«ã‚¨ãƒ©ãƒ¼ã‚µãƒãƒªãƒ¼ãŒè¡¨ç¤ºã•ã‚Œã¾ã™</li>
            </ul>
          </div>

          <div class="example-section">
            <h3 class="ms-font-l">å…¥åŠ›ä¾‹</h3>
            <table class="example-table">
              <tr>
                <th>ä»•è¨³ç•ªå·</th>
                <th>ä»•è¨³æ—¥ä»˜</th>
                <th>æ‘˜è¦</th>
                <th>å€Ÿæ–¹ç§‘ç›®</th>
                <th>å€Ÿæ–¹é‡‘é¡</th>
                <th>è²¸æ–¹ç§‘ç›®</th>
                <th>è²¸æ–¹é‡‘é¡</th>
              </tr>
              <tr>
                <td>J001</td>
                <td>2021-04-01</td>
                <td>å•†å“å£²ä¸Š</td>
                <td>1111</td>
                <td>100000</td>
                <td>4111</td>
                <td>100000</td>
              </tr>
              <tr>
                <td>J002</td>
                <td>2021-04-05</td>
                <td>çµ¦ä¸æ”¯æ‰•</td>
                <td>5111</td>
                <td>300000</td>
                <td>1111</td>
                <td>300000</td>
              </tr>
            </table>
          </div>
        </section>
      </main>
    </div>
  language: html
style:
  content: |
    .ms-welcome {
      display: flex;
      flex-direction: column;
      height: 100%;
    }

    .ms-welcome__header {
      min-height: 100px;
      padding: 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      background: linear-gradient(135deg, #ED7D31 0%, #C65911 100%);
    }

    .ms-welcome__header h1 {
      margin: 0;
      font-size: 24px;
    }

    .ms-welcome__header p {
      margin: 10px 0 0 0;
      font-size: 14px;
    }

    .ms-welcome__main {
      flex: 1;
      padding: 20px;
      overflow-y: auto;
    }

    .ms-welcome__features {
      max-width: 700px;
      margin: 0 auto;
    }

    .ms-welcome__features h2 {
      margin-top: 0;
      margin-bottom: 20px;
      padding-bottom: 10px;
      border-bottom: 2px solid #ED7D31;
    }

    .instruction-section {
      margin-bottom: 25px;
      padding: 15px;
      background-color: #f3f2f1;
      border-radius: 8px;
      border-left: 4px solid #ED7D31;
    }

    .instruction-section.danger {
      background-color: #fef0f0;
      border-left-color: #d32f2f;
    }

    .instruction-section h3 {
      margin-top: 0;
      margin-bottom: 10px;
      color: #ED7D31;
      font-size: 16px;
    }

    .instruction-section.danger h3 {
      color: #d32f2f;
    }

    .instruction-section p {
      margin: 0 0 15px 0;
      line-height: 1.6;
    }

    .note {
      font-size: 12px;
      color: #666;
      font-style: italic;
    }

    .input-table {
      width: 100%;
      margin: 15px 0;
      border-collapse: collapse;
      font-size: 13px;
    }

    .input-table th,
    .input-table td {
      padding: 8px;
      border: 1px solid #ddd;
      text-align: left;
    }

    .input-table th {
      background-color: #ED7D31;
      color: white;
      font-weight: bold;
    }

    .input-table tr:nth-child(even) {
      background-color: #f9f9f9;
    }

    .example-section {
      margin-top: 25px;
      padding: 15px;
      background-color: #e8f5e9;
      border-left: 4px solid #4CAF50;
      border-radius: 8px;
    }

    .example-section h3 {
      margin-top: 0;
      margin-bottom: 10px;
      color: #2e7d32;
    }

    .example-table {
      width: 100%;
      margin-top: 10px;
      border-collapse: collapse;
      font-size: 12px;
    }

    .example-table th,
    .example-table td {
      padding: 6px;
      border: 1px solid #c8e6c9;
      text-align: left;
    }

    .example-table th {
      background-color: #4CAF50;
      color: white;
      font-weight: bold;
    }

    .example-table tr:nth-child(even) {
      background-color: #f1f8e9;
    }

    .button-group {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      margin-top: 15px;
    }

    .ms-Button {
      width: 100%;
      height: 44px;
      font-size: 14px;
      margin-top: 10px;
      border-radius: 4px;
      transition: all 0.2s;
    }

    .button-group .ms-Button {
      margin-top: 0;
    }

    .ms-Button--primary {
      background-color: #ED7D31;
      border-color: #ED7D31;
      color: white;
    }

    .ms-Button--primary:hover {
      background-color: #C65911;
      border-color: #C65911;
      transform: translateY(-1px);
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }

    .ms-Button--hero {
      background-color: #70AD47;
      border-color: #70AD47;
      color: white;
      font-weight: bold;
    }

    .ms-Button--hero:hover {
      background-color: #5a8f38;
      border-color: #5a8f38;
      transform: translateY(-1px);
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }

    .ms-Button--danger {
      background-color: #d32f2f;
      border-color: #d32f2f;
      color: white;
      font-weight: bold;
    }

    .ms-Button--danger:hover {
      background-color: #b71c1c;
      border-color: #b71c1c;
      transform: translateY(-1px);
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }

    .info-section {
      margin-top: 30px;
      padding: 15px;
      background-color: #fff4ce;
      border-left: 4px solid #ffc107;
      border-radius: 8px;
    }

    .info-section h3 {
      margin-top: 0;
      margin-bottom: 10px;
      color: #856404;
    }

    .info-section ul {
      margin: 0;
      padding-left: 20px;
    }

    .info-section li {
      margin-bottom: 8px;
      line-height: 1.6;
      color: #856404;
    }
  language: css
libraries: |
  https://appsforoffice.microsoft.com/lib/1/hosted/office.js
  @types/office-js

  @microsoft/office-js-helpers@1.0.1/dist/office.helpers.min.js
  @microsoft/office-js-helpers@1.0.1/dist/office.helpers.d.ts

  core-js@2.4.1/client/core.min.js
  @types/core-js

  jquery@3.1.1
  @types/jquery@3.3.1
